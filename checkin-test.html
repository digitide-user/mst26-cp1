<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>checkin camera test</title>
  <style>
    body { font-family: system-ui, -apple-system, sans-serif; margin: 16px; }
    button { font-size: 20px; padding: 12px 16px; }
    #msg { margin: 12px 0; white-space: pre-wrap; }
    video { width: 100%; max-width: 640px; background: #000; border-radius: 12px; }
  </style>
</head>
<body>
  <h1>受付カメラ起動テスト（GitHub Pages）</h1>
  <p>CP1本番ページには影響しない検証用ページです。</p>
  <button id="startBtn">カメラ開始</button>
  <div id="msg">未開始</div>
  <video id="video" autoplay playsinline muted></video>

  <script>
    const msg = document.getElementById('msg');
    const video = document.getElementById('video');

    document.getElementById('startBtn').addEventListener('click', async () => {
      try {
        msg.textContent = '開始中…';
        const stream = await navigator.mediaDevices.getUserMedia({
          video: { facingMode: { ideal: 'environment' } },
          audio: false
        });
        video.srcObject = stream;
        msg.textContent = 'カメラ起動OK';
      } catch (e) {
        const name = e && e.name ? e.name : 'UnknownError';
        const m = e && e.message ? e.message : String(e);
        msg.textContent = `カメラ起動NG: ${name}\n${m}`;
        console.error(e);
      }
    });
  </script>
</body>
</html>